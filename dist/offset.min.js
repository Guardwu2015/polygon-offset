(function(z){"object"===typeof exports&&"undefined"!==typeof module?module.exports=z():"function"===typeof define&&define.ga?define([],z):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).Offset=z()})(function(){return function g(d,k,e){function a(c,f){if(!k[c]){if(!d[c]){var n="function"==typeof require&&require;if(!f&&n)return n(c,!0);if(b)return b(c,!0);n=Error("Cannot find module '"+c+"'");throw n.code="MODULE_NOT_FOUND",n;}n=k[c]={exports:{}};
d[c][0].call(n.exports,function(b){var f=d[c][1][b];return a(f?f:b)},n,n.exports,g,d,k,e)}return k[c].exports}for(var b="function"==typeof require&&require,f=0;f<e.length;f++)a(e[f]);return a}({1:[function(g,d){d.exports={V:g("./lib/rbtree"),ba:g("./lib/bintree")}},{"./lib/bintree":2,"./lib/rbtree":3}],2:[function(g,d){function k(a){this.data=a;this.right=this.left=null}function e(a){this.c=null;this.o=a;this.size=0}var a=g("./treebase");k.prototype.g=function(a){return a?this.right:this.left};k.prototype.l=
function(a,f){a?this.right=f:this.left=f};e.prototype=new a;e.prototype.S=function(a){if(null===this.c)return this.c=new k(a),this.size++,!0;for(var f=0,c=null,t=this.c;;){if(null===t)return t=new k(a),c.l(f,t),ret=!0,this.size++,!0;if(0===this.o(t.data,a))return!1;f=0>this.o(t.data,a);c=t;t=t.g(f)}};e.prototype.remove=function(a){if(null===this.c)return!1;var f=new k(void 0),c=f;c.right=this.c;for(var t=null,e=null,h=1;null!==c.g(h);){var t=c,c=c.g(h),d=this.o(a,c.data),h=0<d;0===d&&(e=c)}return null!==
e?(e.data=c.data,t.l(t.right===c,c.g(null===c.left)),this.c=f.right,this.size--,!0):!1};d.exports=e},{"./treebase":4}],3:[function(g,d){function k(a){this.data=a;this.right=this.left=null;this.red=!0}function e(a){this.c=null;this.o=a;this.size=0}function a(a){return null!==a&&a.red}function b(a,c){var b=a.g(!c);a.l(!c,b.g(c));b.l(c,a);a.red=!0;b.red=!1;return b}function f(a,c){a.l(!c,b(a.g(!c),!c));return b(a,c)}var c=g("./treebase");k.prototype.g=function(a){return a?this.right:this.left};k.prototype.l=
function(a,c){a?this.right=c:this.left=c};e.prototype=new c;e.prototype.S=function(c){var e=!1;if(null===this.c)this.c=new k(c),e=!0,this.size++;else{var h=new k(void 0),d=0,g=0,l=null,r=h,m=null,q=this.c;for(r.right=this.c;;){null===q?(q=new k(c),m.l(d,q),e=!0,this.size++):a(q.left)&&a(q.right)&&(q.red=!0,q.left.red=!1,q.right.red=!1);if(a(q)&&a(m)){var u=r.right===l;q===m.g(g)?r.l(u,b(l,!g)):r.l(u,f(l,!g))}u=this.o(q.data,c);if(0===u)break;g=d;d=0>u;null!==l&&(r=l);l=m;m=q;q=q.g(d)}this.c=h.right}this.c.red=
!1;return e};e.prototype.remove=function(c){if(null===this.c)return!1;var e=new k(void 0),h=e;h.right=this.c;for(var d=null,g,l=null,r=1;null!==h.g(r);){var m=r;g=d;var d=h,h=h.g(r),q=this.o(c,h.data),r=0<q;0===q&&(l=h);if(!a(h)&&!a(h.g(r)))if(a(h.g(!r)))g=b(h,r),d.l(m,g),d=g;else if(!a(h.g(!r))&&(q=d.g(!m),null!==q))if(a(q.g(!m))||a(q.g(m))){var u=g.right===d;a(q.g(m))?g.l(u,f(d,m)):a(q.g(!m))&&g.l(u,b(d,m));m=g.g(u);m.red=!0;h.red=!0;m.left.red=!1;m.right.red=!1}else d.red=!1,q.red=!0,h.red=!0}null!==
l&&(l.data=h.data,d.l(d.right===h,h.g(null===h.left)),this.size--);this.c=e.right;null!==this.c&&(this.c.red=!1);return null!==l};d.exports=e},{"./treebase":4}],4:[function(g,d){function k(){}function e(a){this.R=a;this.j=[];this.f=null}k.prototype.clear=function(){this.c=null;this.size=0};k.prototype.find=function(a){for(var b=this.c;null!==b;){var f=this.o(a,b.data);if(0===f)return b.data;b=b.g(0<f)}return null};k.prototype.s=function(a){for(var b=this.c,f=this.iterator();null!==b;){var c=this.o(a,
b.data);if(0===c)return f.f=b,f;f.j.push(b);b=b.g(0<c)}return null};k.prototype.lowerBound=function(a){for(var b=this.c,f=this.iterator(),c=this.o;null!==b;){var e=c(a,b.data);if(0===e)return f.f=b,f;f.j.push(b);b=b.g(0<e)}for(e=f.j.length-1;0<=e;--e)if(b=f.j[e],0>c(a,b.data))return f.f=b,f.j.length=e,f;f.j.length=0;return f};k.prototype.upperBound=function(a){for(var b=this.lowerBound(a),f=this.o;null!==b.data()&&0===f(b.data(),a);)b.next();return b};k.prototype.min=function(){var a=this.c;if(null===
a)return null;for(;null!==a.left;)a=a.left;return a.data};k.prototype.max=function(){var a=this.c;if(null===a)return null;for(;null!==a.right;)a=a.right;return a.data};k.prototype.iterator=function(){return new e(this)};e.prototype.data=function(){return null!==this.f?this.f.data:null};e.prototype.next=function(){if(null===this.f){var a=this.R.c;null!==a&&this.P(a)}else if(null===this.f.right){do if(a=this.f,this.j.length)this.f=this.j.pop();else{this.f=null;break}while(this.f.right===a)}else this.j.push(this.f),
this.P(this.f.right);return null!==this.f?this.f.data:null};e.prototype.H=function(){if(null===this.f){var a=this.R.c;null!==a&&this.O(a)}else if(null===this.f.left){do if(a=this.f,this.j.length)this.f=this.j.pop();else{this.f=null;break}while(this.f.left===a)}else this.j.push(this.f),this.O(this.f.left)};e.prototype.P=function(a){for(;null!==a.left;)this.j.push(a),a=a.left;this.f=a};e.prototype.O=function(a){for(;null!==a.right;)this.j.push(a),a=a.right;this.f=a};d.exports=k},{}],5:[function(g,d){d.exports=
g("./src/index")},{"./src/index":10}],6:[function(g,d){var k=g("./signed_area");d.exports=function(e,a){var b=e.a,f=a.a;return b[0]>f[0]?1:b[0]<f[0]?-1:b[1]!==f[1]?b[1]>f[1]?1:-1:e.left!==a.left?e.left?1:-1:0!==k(b,e.b.a,a.b.a)?e.C(a.b.a)?-1:1:e.h===a.h?e.i===a.i?0:e.i>a.i?1:-1:!e.h&&a.h?1:-1}},{"./signed_area":12}],7:[function(g,d){var k=g("./signed_area"),e=g("./compare_events"),a=g("./equals");d.exports=function(b,f){if(b===f)return 0;if(0!==k(b.a,b.b.a,f.a)||0!==k(b.a,b.b.a,f.b.a))return a(b.a,
f.a)?b.C(f.b.a)?-1:1:b.a[0]===f.a[0]?b.a[1]<f.a[1]?-1:1:1===e(b,f)?f.$(b.a)?-1:1:b.C(f.a)?-1:1;if(b.h===f.h){if(a(b.a,f.a))return b.i===f.i?0:b.i>f.i?1:-1;if(b.h!==f.h)return b.h&&!f.h?1:-1}return 1===e(b,f)?1:-1}},{"./compare_events":6,"./equals":9,"./signed_area":12}],8:[function(g,d){d.exports={J:0,U:1,K:2,I:3}},{}],9:[function(g,d){d.exports=function(d,e){return d[0]===e[0]&&d[1]===e[1]}},{}],10:[function(g,d){function k(a,c,b,f,e){var h,d;if("number"===typeof a[0][0])for(h=0,d=a.length-1;h<d;h++){var t=
a[h],g=a[h+1],n=c,p=b+1,r=f,l=e,v=new m(t,!1,void 0,n),g=new m(g,!1,v,n);v.b=g;v.i=g.i=p;0<q(v,g)?g.left=!0:v.left=!0;l[0]=y(l[0],t[0]);l[1]=y(l[1],t[1]);l[2]=B(l[2],t[0]);l[3]=B(l[3],t[1]);r.push(v);r.push(g)}else for(h=0,d=a.length;h<d;h++)A++,k(a[h],c,A,f,e)}function e(a,c,b,f){var e=new l(null,q);A=0;k(a,!0,0,e,b);k(c,!1,0,e,f);return e}function a(a,c,f,e){null===c?(a.v=!1,a.u=!0):a.h===c.h?(a.v=!c.v,a.u=c.u):(a.v=!c.u,a.u=c.T()?!c.v:c.v);c&&(a.B=!b(c,e)||c.T()?c.B:c);a.G=b(a,e)}function b(a,
c){switch(a.type){case v.J:switch(c){case 0:return!a.u;case 1:return a.u;case 2:return a.h&&a.u||!a.h&&!a.u;case 3:return!0}case v.K:return 0===c||1===c;case v.I:return 2===c}return!1}function f(a,b,f){var e=C(a.a,a.b.a,b.a,b.b.a),h=e?e.length:0;if(0===h||1===h&&(x(a.a,b.a)||x(a.b.a,b.b.a)))return 0;if(2===h&&a.h===b.h)return a.i===b.i&&console.warn("Edges of the same polygon overlap",a.a,a.b.a,b.a,b.b.a),0;if(1===h)return x(a.a,e[0])||x(a.b.a,e[0])||c(a,e[0],f),x(b.a,e[0])||x(b.b.a,e[0])||c(b,e[0],
f),1;var e=[],d=h=!1;x(a.a,b.a)?h=!0:1===q(a,b)?e.push(b,a):e.push(a,b);x(a.b.a,b.b.a)?d=!0:1===q(a.b,b.b)?e.push(b.b,a.b):e.push(a.b,b.b);if(h&&d||h)return a.type=v.U,b.type=a.v===b.v?v.K:v.I,h&&!d&&c(e[0].b,e[1].a,f),2;if(d)return c(e[0],e[1].a,f),3;if(e[0]!==e[3].b)return c(e[0],e[1].a,f),c(e[1],e[2].a,f),3;c(e[0],e[1].a,f);c(e[3].b,e[2].a,f);return 3}function c(a,c,b){var e=new m(c,!1,a,a.h);c=new m(c,!0,a.b,a.h);0<q(c,a.b)&&(a.b.left=!0,c.left=!1);a.b.b=c;a.b=e;b.push(c);b.push(e);return b}function t(c,
b,e,h,d,t){var g;e=new r(u);b=[];for(var k=y(h[2],d[2]);c.length;){var n=c.pop();b.push(n);if(0===t&&n.a[0]>k||2===t&&n.a[0]>h[2])break;n.left?(e.S(n),g=e.s(n),d=e.s(n),n.iterator=e.s(n),d.data()!==e.min()?d.H():(d=e.s(e.max()),d.next()),g.next(),a(n,d.data(),0,t),g.data()&&2===f(n,g.data(),c)&&(a(n,d.data(),0,t),a(n,g.data(),0,t)),d.data()&&2===f(d.data(),n,c)&&(g=e.s(d.data()),g.data()!==e.min()?g.H():(g=e.s(e.max()),g.next()),a(d.data(),g.data(),0,t),a(n,d.data(),0,t))):(n=n.b,g=e.s(n),(d=e.s(n))&&
g&&(d.data()!==e.min()?d.H():(d=e.s(e.max()),d.next()),g.next(),e.remove(n),g.data()&&d.data()&&f(d.data(),g.data(),c)))}return b}function n(a,c){"[object Array]"===Object.prototype.toString.call(a[0][0])||(a=[a]);a[c]=[]}function h(a,c,b){var f,d=null;if(0===a.length*c.length)if(0===b)d=w;else if(2===b)d=a;else if(1===b||3===b)d=0===a.length?c:a;if(f=d)return f===w?null:f;var d=[Infinity,Infinity,-Infinity,-Infinity],h=[Infinity,Infinity,-Infinity,-Infinity],g=e(a,c,d,h);f=null;if(d[0]>h[2]||h[0]>
d[2]||d[1]>h[3]||h[1]>d[3])if(0===b)f=w;else if(2===b)f=a;else if(1===b||3===b)f=a.concat(c);if(f)return f===w?null:f;d=t(g,0,0,d,h,b);a=[];c=0;for(b=d.length;c<b;c++)h=d[c],(h.left&&h.G||!h.left&&h.b.G)&&a.push(h);for(d=!1;!d;)for(d=!0,c=0,b=a.length;c<b;c++)c+1<b&&1===q(a[c],a[c+1])&&(d=a,h=c+1,g=d[c],d[c]=d[h],d[h]=g,d=!1);c=0;for(b=a.length;c<b;c++)a[c].A=c,a[c].left||(d=a[c].A,a[c].A=a[c].b.A,a[c].b.A=d);d=Array(a.length);h=[];g=[];f=[];var k={};c=0;for(b=a.length;c<b;c++)if(!d[c]){var m=[];
h.push(m);var l=h.length-1;g.push(0);f.push(-1);if(a[c].B){var p=a[c].B.i;a[c].B.D?k[p]&&(n(h[f[p]],l),f[l]=f[p],g[l]=g[p],k[l]=!0):(n(h[p],l),f[l]=p,g[l]=g[p]+1,k[l]=!0)}p=c;for(m.push(a[c].a);p>=c;){d[p]=!0;a[p].left?(a[p].D=!1,a[p].i=l):(a[p].b.D=!0,a[p].b.i=l);p=a[p].A;d[p]=!0;m.push(a[p].a);a:{for(var r=a,v=d,u=p+1,y=r.length;u<y&&x(r[u].a,r[p].a);)if(v[u])u+=1;else{p=u;break a}for(u=p-1;v[u];)--u;p=u}}p=-1===p?c:p;d[p]=d[a[p].A]=!0;a[p].b.D=!0;a[p].b.i=l;g[l]&1&&m.reverse()}return h}var w=[],
v=g("./edge_type"),l=g("tinyqueue"),r=g("bintrees").V,m=g("./sweep_event"),q=g("./compare_events"),u=g("./compare_segments"),C=g("./segment_intersection"),x=g("./equals"),B=Math.max,y=Math.min,A=0;d.exports=h;d.exports.union=function(a,c){return h(a,c,1)};d.exports.diff=function(a,c){return h(a,c,2)};d.exports.na=function(a,c){return h(a,c,3)};d.exports.intersection=function(a,c){return h(a,c,0)};d.exports.ka={da:0,ca:2,ea:1,fa:3};d.exports.ja=e;d.exports.ha=a;d.exports.ma=t;d.exports.ia=c;d.exports.la=
f},{"./compare_events":6,"./compare_segments":7,"./edge_type":8,"./equals":9,"./segment_intersection":11,"./sweep_event":13,bintrees:1,tinyqueue:14}],11:[function(g,d){function k(a,b){return a[0]*b[1]-a[1]*b[0]}function e(a,b){return a[0]*b[0]+a[1]*b[1]}d.exports=function(a,b,f,c,d){function g(a,c,b){return[a[0]+c*b[0],a[1]+c*b[1]]}b=[b[0]-a[0],b[1]-a[1]];c=[c[0]-f[0],c[1]-f[1]];f=[f[0]-a[0],f[1]-a[1]];var h=k(b,c),w=e(b,b);if(h*h>1E-9*w*e(c,c)){c=k(f,c)/h;if(0>c||1<c)return null;f=k(f,b)/h;return 0>
f||1<f?null:d?null:[g(a,c,b)]}var v=e(f,f),h=k(f,b);if(h*h>1E-9*w*v)return null;f=e(b,f)/w;h=f+e(b,c)/w;c=Math.min(f,h);f=Math.max(f,h);return 1>=c&&0<=f?1===c?d?null:[g(a,0<c?c:0,b)]:0===f?d?null:[g(a,1>f?f:1,b)]:d&&0===c&&1===f?null:[g(a,0<c?c:0,b),g(a,1>f?f:1,b)]:null}},{}],12:[function(g,d){d.exports=function(d,e,a){return(d[0]-a[0])*(e[1]-a[1])-(e[0]-a[0])*(d[1]-a[1])}},{}],13:[function(g,d){function k(b,e,c,d,g){this.left=e;this.a=b;this.b=c;this.h=d;this.type=g||a.J;this.u=this.v=!1;this.B=
null;this.D=this.G=!1}var e=g("./signed_area"),a=g("./edge_type");k.prototype={C:function(a){return this.left?0<e(this.a,this.b.a,a):0<e(this.b.a,this.a,a)},$:function(a){return!this.C(a)},T:function(){return this.a[0]===this.b.a[0]}};d.exports=k},{"./edge_type":8,"./signed_area":12}],14:[function(g,d){function k(a,b){if(!(this instanceof k))return new k(a,b);this.data=a||[];this.length=this.data.length;this.compare=b||e;if(a)for(var d=Math.floor(this.length/2);0<=d;d--)this.M(d)}function e(a,b){return a<
b?-1:a>b?1:0}d.exports=k;k.prototype={push:function(a){this.data.push(a);this.length++;this.X(this.length-1)},pop:function(){var a=this.data[0];this.data[0]=this.data[this.length-1];this.length--;this.data.pop();this.M(0);return a},X:function(a){for(var b=this.data,e=this.compare;0<a;){var c=Math.floor((a-1)/2);if(0>e(b[a],b[c])){var d=b,g=d[c];d[c]=d[a];d[a]=g;a=c}else break}},M:function(a){for(var b=this.data,e=this.compare,c=this.length;;){var d=2*a+1,g=d+1,h=a;d<c&&0>e(b[d],b[h])&&(h=d);g<c&&
0>e(b[g],b[h])&&(h=g);if(h===a)break;d=b;g=d[h];d[h]=d[a];d[a]=g;a=h}}}},{}],15:[function(g,d){function k(d,a){this.current=d;this.next=a;this.N=this.Z()}k.prototype.Z=function(){var d=this.next[0]-this.current[0],a=this.next[1]-this.current[1],b=Math.sqrt(d*d+a*a);return[-a/b,d/b]};k.prototype.offset=function(d,a){var b=this.current,f=this.next;return new k([b[0]+d,b[1]+a],[f[0]+d,f[1]+a])};d.exports=k},{}],16:[function(g,d){(function(k){function e(a,b){this.m=null;this.F=!1;a&&this.data(a);this.L=
void 0!==b?b:5}var a=g("./edge"),b=k.martinez=g("martinez-polygon-clipping"),f=Math.atan2;e.prototype.data=function(c){c=this.aa(c);for(var b=[],d=0,e=c.length;d<e;d++)b.push(new a(c[d],c[(d+1)%e]));this.m=c;return this};e.prototype.arcSegments=function(a){this.L=a;return this};e.prototype.aa=function(a){var b=a.length;a[0][0]===a[b-1][0]&&a[0][1]===a[b-1][1]&&(a=a.slice(0,b-1),this.F=!0);return a};e.prototype.Y=function(a,b,d,e,g,k){var l=2*Math.PI,r=f(e[1]-b[1],e[0]-b[0]),m=f(g[1]-b[1],g[0]-b[0]);
0===k%2&&--k;0>r&&(r+=l);0>m&&(m+=l);l=-(r>m?r-m:r+l-m)/k;a.push(e);for(m=1;m<k;++m)e=r+l*m,a.push([b[0]+Math.cos(e)*d,b[1]+Math.sin(e)*d]);a.push(g)};e.prototype.w=function(a){this.F&&a.push([a[0][0],a[0][1]]);return a};e.prototype.offset=function(a){return 0===a?this.m:0<a?this.margin(a):this.padding(-a)};e.prototype.W=function(c,b,d){var e=[];c=[new a(c,b),new a(b,c)];var f=[];for(b=0;2>b;b++){var g=c[b];f.push(g.offset(g.N[0]*d,g.N[1]*d))}for(b=0;2>b;b++)this.Y(e,c[b].current,d,f[(b+2-1)%2].next,
f[b].current,this.L);return e};e.prototype.margin=function(a){if(0===a)return this.w(this.m);this.w(this.m);a=this.offsetLine(a);return a=b.union(a,[this.w(this.m)])};e.prototype.padding=function(a){if(0===a)return this.w(this.m);this.w(this.m);a=this.offsetLine(a);return b.diff(this.m,a)};e.prototype.offsetLine=function(a){if(0===a)return this.m;var d=[],e=[];this.F=!0;for(var f=0,g=this.m.length-1;f<g;f++){var k=this.w(this.W(this.m[f],this.m[f+1],a));d.push(k);e=0===f?k:b.union(e,k)}return 2<this.m.length?
e:[e]};d.exports=e}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./edge":15,"martinez-polygon-clipping":5}]},{},[16])(16)});
