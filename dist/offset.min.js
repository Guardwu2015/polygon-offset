(function(z){"object"===typeof exports&&"undefined"!==typeof module?module.exports=z():"function"===typeof define&&define.ia?define([],z):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).Offset=z()})(function(){return function h(f,k,d){function a(c,l){if(!k[c]){if(!f[c]){var e="function"==typeof require&&require;if(!l&&e)return e(c,!0);if(b)return b(c,!0);e=Error("Cannot find module '"+c+"'");throw e.code="MODULE_NOT_FOUND",e;}e=k[c]={exports:{}};
f[c][0].call(e.exports,function(b){var e=f[c][1][b];return a(e?e:b)},e,e.exports,h,f,k,d)}return k[c].exports}for(var b="function"==typeof require&&require,e=0;e<d.length;e++)a(d[e]);return a}({1:[function(h,f){f.exports={W:h("./lib/rbtree"),da:h("./lib/bintree")}},{"./lib/bintree":2,"./lib/rbtree":3}],2:[function(h,f){function k(a){this.data=a;this.right=this.left=null}function d(a){this.c=null;this.s=a;this.size=0}var a=h("./treebase");k.prototype.g=function(a){return a?this.right:this.left};k.prototype.m=
function(a,e){a?this.right=e:this.left=e};d.prototype=new a;d.prototype.T=function(a){if(null===this.c)return this.c=new k(a),this.size++,!0;for(var e=0,c=null,l=this.c;;){if(null===l)return l=new k(a),c.m(e,l),ret=!0,this.size++,!0;if(0===this.s(l.data,a))return!1;e=0>this.s(l.data,a);c=l;l=l.g(e)}};d.prototype.remove=function(a){if(null===this.c)return!1;var e=new k(void 0),c=e;c.right=this.c;for(var l=null,d=null,g=1;null!==c.g(g);){var l=c,c=c.g(g),f=this.s(a,c.data),g=0<f;0===f&&(d=c)}return null!==
d?(d.data=c.data,l.m(l.right===c,c.g(null===c.left)),this.c=e.right,this.size--,!0):!1};f.exports=d},{"./treebase":4}],3:[function(h,f){function k(a){this.data=a;this.right=this.left=null;this.red=!0}function d(a){this.c=null;this.s=a;this.size=0}function a(a){return null!==a&&a.red}function b(a,c){var b=a.g(!c);a.m(!c,b.g(c));b.m(c,a);a.red=!0;b.red=!1;return b}function e(a,c){a.m(!c,b(a.g(!c),!c));return b(a,c)}var c=h("./treebase");k.prototype.g=function(a){return a?this.right:this.left};k.prototype.m=
function(a,c){a?this.right=c:this.left=c};d.prototype=new c;d.prototype.T=function(c){var d=!1;if(null===this.c)this.c=new k(c),d=!0,this.size++;else{var g=new k(void 0),f=0,h=0,n=null,r=g,m=null,q=this.c;for(r.right=this.c;;){null===q?(q=new k(c),m.m(f,q),d=!0,this.size++):a(q.left)&&a(q.right)&&(q.red=!0,q.left.red=!1,q.right.red=!1);if(a(q)&&a(m)){var u=r.right===n;q===m.g(h)?r.m(u,b(n,!h)):r.m(u,e(n,!h))}u=this.s(q.data,c);if(0===u)break;h=f;f=0>u;null!==n&&(r=n);n=m;m=q;q=q.g(f)}this.c=g.right}this.c.red=
!1;return d};d.prototype.remove=function(c){if(null===this.c)return!1;var d=new k(void 0),g=d;g.right=this.c;for(var f=null,h,n=null,r=1;null!==g.g(r);){var m=r;h=f;var f=g,g=g.g(r),q=this.s(c,g.data),r=0<q;0===q&&(n=g);if(!a(g)&&!a(g.g(r)))if(a(g.g(!r)))h=b(g,r),f.m(m,h),f=h;else if(!a(g.g(!r))&&(q=f.g(!m),null!==q))if(a(q.g(!m))||a(q.g(m))){var u=h.right===f;a(q.g(m))?h.m(u,e(f,m)):a(q.g(!m))&&h.m(u,b(f,m));m=h.g(u);m.red=!0;g.red=!0;m.left.red=!1;m.right.red=!1}else f.red=!1,q.red=!0,g.red=!0}null!==
n&&(n.data=g.data,f.m(f.right===g,g.g(null===g.left)),this.size--);this.c=d.right;null!==this.c&&(this.c.red=!1);return null!==n};f.exports=d},{"./treebase":4}],4:[function(h,f){function k(){}function d(a){this.S=a;this.l=[];this.f=null}k.prototype.clear=function(){this.c=null;this.size=0};k.prototype.find=function(a){for(var b=this.c;null!==b;){var e=this.s(a,b.data);if(0===e)return b.data;b=b.g(0<e)}return null};k.prototype.u=function(a){for(var b=this.c,e=this.iterator();null!==b;){var c=this.s(a,
b.data);if(0===c)return e.f=b,e;e.l.push(b);b=b.g(0<c)}return null};k.prototype.lowerBound=function(a){for(var b=this.c,e=this.iterator(),c=this.s;null!==b;){var d=c(a,b.data);if(0===d)return e.f=b,e;e.l.push(b);b=b.g(0<d)}for(d=e.l.length-1;0<=d;--d)if(b=e.l[d],0>c(a,b.data))return e.f=b,e.l.length=d,e;e.l.length=0;return e};k.prototype.upperBound=function(a){for(var b=this.lowerBound(a),e=this.s;null!==b.data()&&0===e(b.data(),a);)b.next();return b};k.prototype.min=function(){var a=this.c;if(null===
a)return null;for(;null!==a.left;)a=a.left;return a.data};k.prototype.max=function(){var a=this.c;if(null===a)return null;for(;null!==a.right;)a=a.right;return a.data};k.prototype.iterator=function(){return new d(this)};d.prototype.data=function(){return null!==this.f?this.f.data:null};d.prototype.next=function(){if(null===this.f){var a=this.S.c;null!==a&&this.R(a)}else if(null===this.f.right){do if(a=this.f,this.l.length)this.f=this.l.pop();else{this.f=null;break}while(this.f.right===a)}else this.l.push(this.f),
this.R(this.f.right);return null!==this.f?this.f.data:null};d.prototype.J=function(){if(null===this.f){var a=this.S.c;null!==a&&this.P(a)}else if(null===this.f.left){do if(a=this.f,this.l.length)this.f=this.l.pop();else{this.f=null;break}while(this.f.left===a)}else this.l.push(this.f),this.P(this.f.left)};d.prototype.R=function(a){for(;null!==a.left;)this.l.push(a),a=a.left;this.f=a};d.prototype.P=function(a){for(;null!==a.right;)this.l.push(a),a=a.right;this.f=a};f.exports=k},{}],5:[function(h,f){f.exports=
h("./src/index")},{"./src/index":10}],6:[function(h,f){var k=h("./signed_area");f.exports=function(d,a){var b=d.a,e=a.a;return b[0]>e[0]?1:b[0]<e[0]?-1:b[1]!==e[1]?b[1]>e[1]?1:-1:d.left!==a.left?d.left?1:-1:0!==k(b,d.b.a,a.b.a)?d.D(a.b.a)?-1:1:d.h===a.h?d.j===a.j?0:d.j>a.j?1:-1:!d.h&&a.h?1:-1}},{"./signed_area":12}],7:[function(h,f){var k=h("./signed_area"),d=h("./compare_events"),a=h("./equals");f.exports=function(b,e){if(b===e)return 0;if(0!==k(b.a,b.b.a,e.a)||0!==k(b.a,b.b.a,e.b.a))return a(b.a,
e.a)?b.D(e.b.a)?-1:1:b.a[0]===e.a[0]?b.a[1]<e.a[1]?-1:1:1===d(b,e)?e.aa(b.a)?-1:1:b.D(e.a)?-1:1;if(b.h===e.h){if(a(b.a,e.a))return b.j===e.j?0:b.j>e.j?1:-1;if(b.h!==e.h)return b.h&&!e.h?1:-1}return 1===d(b,e)?1:-1}},{"./compare_events":6,"./equals":9,"./signed_area":12}],8:[function(h,f){f.exports={L:0,V:1,M:2,K:3}},{}],9:[function(h,f){f.exports=function(f,d){return f[0]===d[0]&&f[1]===d[1]}},{}],10:[function(h,f){function k(a,c,b,e,d){var l,f;if("number"===typeof a[0][0])for(l=0,f=a.length-1;l<
f;l++){var g=a[l],h=a[l+1],t=c,p=b+1,r=e,v=d,n=new m(g,!1,void 0,t),h=new m(h,!1,n,t);n.b=h;n.j=h.j=p;0<q(n,h)?h.left=!0:n.left=!0;v[0]=y(v[0],g[0]);v[1]=y(v[1],g[1]);v[2]=B(v[2],g[0]);v[3]=B(v[3],g[1]);r.push(n);r.push(h)}else for(l=0,f=a.length;l<f;l++)A++,k(a[l],c,A,e,d)}function d(a,c,b,e){var d=new n(null,q);A=0;k(a,!0,0,d,b);k(c,!1,0,d,e);return d}function a(a,c,e,d){null===c?(a.w=!1,a.v=!0):a.h===c.h?(a.w=!c.w,a.v=c.v):(a.w=!c.v,a.v=c.U()?!c.w:c.w);c&&(a.C=!b(c,d)||c.U()?c.C:c);a.I=b(a,d)}
function b(a,c){switch(a.type){case w.L:switch(c){case 0:return!a.v;case 1:return a.v;case 2:return a.h&&a.v||!a.h&&!a.v;case 3:return!0}case w.M:return 0===c||1===c;case w.K:return 2===c}return!1}function e(a,b,e){var d=C(a.a,a.b.a,b.a,b.b.a),l=d?d.length:0;if(0===l||1===l&&(x(a.a,b.a)||x(a.b.a,b.b.a)))return 0;if(2===l&&a.h===b.h)return a.j===b.j&&console.warn("Edges of the same polygon overlap",a.a,a.b.a,b.a,b.b.a),0;if(1===l)return x(a.a,d[0])||x(a.b.a,d[0])||c(a,d[0],e),x(b.a,d[0])||x(b.b.a,
d[0])||c(b,d[0],e),1;var d=[],g=l=!1;x(a.a,b.a)?l=!0:1===q(a,b)?d.push(b,a):d.push(a,b);x(a.b.a,b.b.a)?g=!0:1===q(a.b,b.b)?d.push(b.b,a.b):d.push(a.b,b.b);if(l&&g||l)return a.type=w.V,b.type=a.w===b.w?w.M:w.K,l&&!g&&c(d[0].b,d[1].a,e),2;if(g)return c(d[0],d[1].a,e),3;if(d[0]!==d[3].b)return c(d[0],d[1].a,e),c(d[1],d[2].a,e),3;c(d[0],d[1].a,e);c(d[3].b,d[2].a,e);return 3}function c(a,c,b){var e=new m(c,!1,a,a.h);c=new m(c,!0,a.b,a.h);0<q(c,a.b)&&(a.b.left=!0,c.left=!1);a.b.b=c;a.b=e;b.push(c);b.push(e);
return b}function l(c,b,d,l,g,f){var h;d=new r(u);b=[];for(var k=y(l[2],g[2]);c.length;){var t=c.pop();b.push(t);if(0===f&&t.a[0]>k||2===f&&t.a[0]>l[2])break;t.left?(d.T(t),h=d.u(t),g=d.u(t),t.iterator=d.u(t),g.data()!==d.min()?g.J():(g=d.u(d.max()),g.next()),h.next(),a(t,g.data(),0,f),h.data()&&2===e(t,h.data(),c)&&(a(t,g.data(),0,f),a(t,h.data(),0,f)),g.data()&&2===e(g.data(),t,c)&&(h=d.u(g.data()),h.data()!==d.min()?h.J():(h=d.u(d.max()),h.next()),a(g.data(),h.data(),0,f),a(t,g.data(),0,f))):(t=
t.b,h=d.u(t),(g=d.u(t))&&h&&(g.data()!==d.min()?g.J():(g=d.u(d.max()),g.next()),h.next(),d.remove(t),h.data()&&g.data()&&e(g.data(),h.data(),c)))}return b}function t(a,c){"[object Array]"===Object.prototype.toString.call(a[0][0])||(a=[a]);a[c]=[]}function g(a,c,b){var e,g=null;if(0===a.length*c.length)if(0===b)g=v;else if(2===b)g=a;else if(1===b||3===b)g=0===a.length?c:a;if(e=g)return e===v?null:e;var g=[Infinity,Infinity,-Infinity,-Infinity],f=[Infinity,Infinity,-Infinity,-Infinity],h=d(a,c,g,f);
e=null;if(g[0]>f[2]||f[0]>g[2]||g[1]>f[3]||f[1]>g[3])if(0===b)e=v;else if(2===b)e=a;else if(1===b||3===b)e=a.concat(c);if(e)return e===v?null:e;g=l(h,0,0,g,f,b);a=[];c=0;for(b=g.length;c<b;c++)f=g[c],(f.left&&f.I||!f.left&&f.b.I)&&a.push(f);for(g=!1;!g;)for(g=!0,c=0,b=a.length;c<b;c++)c+1<b&&1===q(a[c],a[c+1])&&(g=a,f=c+1,h=g[c],g[c]=g[f],g[f]=h,g=!1);c=0;for(b=a.length;c<b;c++)a[c].B=c,a[c].left||(g=a[c].B,a[c].B=a[c].b.B,a[c].b.B=g);g=Array(a.length);f=[];h=[];e=[];var k={};c=0;for(b=a.length;c<
b;c++)if(!g[c]){var m=[];f.push(m);var n=f.length-1;h.push(0);e.push(-1);if(a[c].C){var p=a[c].C.j;a[c].C.F?k[p]&&(t(f[e[p]],n),e[n]=e[p],h[n]=h[p],k[n]=!0):(t(f[p],n),e[n]=p,h[n]=h[p]+1,k[n]=!0)}p=c;for(m.push(a[c].a);p>=c;){g[p]=!0;a[p].left?(a[p].F=!1,a[p].j=n):(a[p].b.F=!0,a[p].b.j=n);p=a[p].B;g[p]=!0;m.push(a[p].a);a:{for(var r=a,w=g,u=p+1,y=r.length;u<y&&x(r[u].a,r[p].a);)if(w[u])u+=1;else{p=u;break a}for(u=p-1;w[u];)--u;p=u}}p=-1===p?c:p;g[p]=g[a[p].B]=!0;a[p].b.F=!0;a[p].b.j=n;h[n]&1&&m.reverse()}return f}
var v=[],w=h("./edge_type"),n=h("tinyqueue"),r=h("bintrees").W,m=h("./sweep_event"),q=h("./compare_events"),u=h("./compare_segments"),C=h("./segment_intersection"),x=h("./equals"),B=Math.max,y=Math.min,A=0;f.exports=g;f.exports.union=function(a,c){return g(a,c,1)};f.exports.diff=function(a,c){return g(a,c,2)};f.exports.pa=function(a,c){return g(a,c,3)};f.exports.intersection=function(a,c){return g(a,c,0)};f.exports.ma={fa:0,ea:2,ga:1,ha:3};f.exports.la=d;f.exports.ja=a;f.exports.oa=l;f.exports.ka=
c;f.exports.na=e},{"./compare_events":6,"./compare_segments":7,"./edge_type":8,"./equals":9,"./segment_intersection":11,"./sweep_event":13,bintrees:1,tinyqueue:14}],11:[function(h,f){function k(a,b){return a[0]*b[1]-a[1]*b[0]}function d(a,b){return a[0]*b[0]+a[1]*b[1]}f.exports=function(a,b,e,c,f){function h(a,c,b){return[a[0]+c*b[0],a[1]+c*b[1]]}b=[b[0]-a[0],b[1]-a[1]];c=[c[0]-e[0],c[1]-e[1]];e=[e[0]-a[0],e[1]-a[1]];var g=k(b,c),v=d(b,b);if(g*g>1E-9*v*d(c,c)){c=k(e,c)/g;if(0>c||1<c)return null;e=
k(e,b)/g;return 0>e||1<e?null:f?null:[h(a,c,b)]}var w=d(e,e),g=k(e,b);if(g*g>1E-9*v*w)return null;e=d(b,e)/v;g=e+d(b,c)/v;c=Math.min(e,g);e=Math.max(e,g);return 1>=c&&0<=e?1===c?f?null:[h(a,0<c?c:0,b)]:0===e?f?null:[h(a,1>e?e:1,b)]:f&&0===c&&1===e?null:[h(a,0<c?c:0,b),h(a,1>e?e:1,b)]:null}},{}],12:[function(h,f){f.exports=function(f,d,a){return(f[0]-a[0])*(d[1]-a[1])-(d[0]-a[0])*(f[1]-a[1])}},{}],13:[function(h,f){function k(b,e,c,d,f){this.left=e;this.a=b;this.b=c;this.h=d;this.type=f||a.L;this.v=
this.w=!1;this.C=null;this.F=this.I=!1}var d=h("./signed_area"),a=h("./edge_type");k.prototype={D:function(a){return this.left?0<d(this.a,this.b.a,a):0<d(this.b.a,this.a,a)},aa:function(a){return!this.D(a)},U:function(){return this.a[0]===this.b.a[0]}};f.exports=k},{"./edge_type":8,"./signed_area":12}],14:[function(h,f){function k(a,b){if(!(this instanceof k))return new k(a,b);this.data=a||[];this.length=this.data.length;this.compare=b||d;if(a)for(var e=Math.floor(this.length/2);0<=e;e--)this.N(e)}
function d(a,b){return a<b?-1:a>b?1:0}f.exports=k;k.prototype={push:function(a){this.data.push(a);this.length++;this.Y(this.length-1)},pop:function(){var a=this.data[0];this.data[0]=this.data[this.length-1];this.length--;this.data.pop();this.N(0);return a},Y:function(a){for(var b=this.data,e=this.compare;0<a;){var c=Math.floor((a-1)/2);if(0>e(b[a],b[c])){var d=b,f=d[c];d[c]=d[a];d[a]=f;a=c}else break}},N:function(a){for(var b=this.data,d=this.compare,c=this.length;;){var f=2*a+1,h=f+1,g=a;f<c&&0>
d(b[f],b[g])&&(g=f);h<c&&0>d(b[h],b[g])&&(g=h);if(g===a)break;f=b;h=f[g];f[g]=f[a];f[a]=h;a=g}}}},{}],15:[function(h,f){function k(d,a){this.current=d;this.next=a;this.O=this.$()}k.prototype.$=function(){var d=this.next[0]-this.current[0],a=this.next[1]-this.current[1],b=Math.sqrt(d*d+a*a);return[-a/b,d/b]};k.prototype.offset=function(d,a){var b=this.current,e=this.next;return new k([b[0]+d,b[1]+a],[e[0]+d,e[1]+a])};f.exports=k},{}],16:[function(h,f){(function(k){function d(a,b){this.i=null;this.H=
!1;this.o=0;a&&this.data(a);this.G=void 0!==b?b:5}var a=h("./edge"),b=k.martinez=h("martinez-polygon-clipping"),e=Math.atan2;d.prototype.data=function(c){c=this.ca(c);if(1<c.length)for(var b=[],d=0,e=c.length;d<e;d++)b.push(new a(c[d],c[(d+1)%e]));this.i=c;return this};d.prototype.arcSegments=function(a){this.G=a;return this};d.prototype.ca=function(a){var b=a.length;if("number"===typeof a[0])return[a];a[0][0]===a[b-1][0]&&a[0][1]===a[b-1][1]&&1<b&&(a=a.slice(0,b-1),this.H=!0);return a};d.prototype.Z=
function(a,b,d,g,f,h){var k=2*Math.PI,r=e(g[1]-b[1],g[0]-b[0]),m=e(f[1]-b[1],f[0]-b[0]);0===h%2&&--h;0>r&&(r+=k);0>m&&(m+=k);k=-(r>m?r-m:r+k-m)/h;a.push(g);for(m=1;m<h;++m)g=r+k*m,a.push([b[0]+Math.cos(g)*d,b[1]+Math.sin(g)*d]);a.push(f)};d.prototype.distance=function(a){this.o=a||0;return this};d.degreesToUnits=function(a,b){switch(b){case "miles":a/=69.047;break;case "feet":a/=364568;break;case "kilometers":a/=111.12;break;case "meters":case "metres":a/=111120}return a};d.prototype.A=function(a){this.H&&
a.push([a[0][0],a[0][1]]);return a};d.prototype.offset=function(a){this.distance(a);return 0===this.o?this.i:0<this.o?this.margin(this.o):this.padding(-this.o)};d.prototype.X=function(c,b,d){var e=[];c=[new a(c,b),new a(b,c)];var f=[];for(b=0;2>b;b++){var h=c[b];f.push(h.offset(h.O[0]*d,h.O[1]*d))}for(b=0;2>b;b++)this.Z(e,c[b].current,d,f[(b+2-1)%2].next,f[b].current,this.G);return e};d.prototype.margin=function(a){this.distance(a);if(0===a)return this.A(this.i);if(1===this.i.length)return this.ba(this.o);
this.A(this.i);a=this.offsetLine(this.o);return a=b.union(a,[this.A(this.i)])};d.prototype.padding=function(a){this.distance(a);if(0===this.o)return this.A(this.i);if(1===this.i.length)return this.i;this.A(this.i);a=this.offsetLine(this.o);return b.diff(this.i,a)};d.prototype.offsetLine=function(a){this.distance(a);if(0===this.o)return this.i;a=[];var d=[];this.H=!0;for(var e=0,f=this.i.length-1;e<f;e++){var h=this.A(this.X(this.i[e],this.i[e+1],this.o));a.push(h);d=0===e?h:b.union(d,h)}return 2<
this.i.length?d:[d]};d.prototype.ba=function(a){this.distance(a);a=2*this.G;for(var b=[],d=this.i[0],e=this.o,f=0,h=0;h<a-1;h++)f+=2*Math.PI/a,b.push([d[0]+e*Math.cos(f),d[1]+e*Math.sin(f)]);return b};f.exports=d}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./edge":15,"martinez-polygon-clipping":5}]},{},[16])(16)});
